
echo ""
echo "**************************************************************************"
echo "******************************** clean up ********************************"
echo "**************************************************************************"
echo ""

rm -rf src/templates/cache/
rm -rf mails/

echo ""
echo "**************************************************************************"
echo "****************************** php-cs-fixer ******************************"
echo "**************************************************************************"
echo ""

../webapp/vendor/bin/php-cs-fixer fix src
../webapp/vendor/bin/php-cs-fixer fix tests

echo ""
echo "**************************************************************************"
echo "******************************** csfix.php *******************************"
echo "**************************************************************************"
echo ""

php ../webapp/csfix.php src
php ../webapp/csfix.php tests

echo ""
echo "**************************************************************************"
echo "********************************* phpcbf *********************************"
echo "**************************************************************************"
echo ""

../webapp/vendor/bin/phpcbf src
../webapp/vendor/bin/phpcbf tests

set -e

echo ""
echo "**************************************************************************"
echo "********************************** phpcs *********************************"
echo "**************************************************************************"
echo ""

../webapp/vendor/bin/phpcs src --ignore=*/config/*
../webapp/vendor/bin/phpcs tests

echo ""
echo "**************************************************************************"
echo "********************************* phpstan ********************************"
echo "**************************************************************************"
echo ""

../webapp/vendor/bin/phpstan analyse --level 8 src
../webapp/vendor/bin/phpstan analyse --level 8 tests

echo ""
echo "**************************************************************************"
echo "********************************** phpmd *********************************"
echo "**************************************************************************"
echo ""

../webapp/vendor/bin/phpmd src text cleancode,codesize,controversial,design,naming,unusedcode
../webapp/vendor/bin/phpmd tests text cleancode,codesize,controversial,design,naming,unusedcode

echo ""
echo "**************************************************************************"
echo "********************************** test **********************************"
echo "**************************************************************************"
echo ""

php test.php

echo "TESTS PASSED"